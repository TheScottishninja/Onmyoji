<div class="section tabs-wrapper">
    <input type="radio" name="attr_tab" value="basics" class="tab-button basics-tab" checked />
    <div class="tab basics-tab"a>Basics</div>

    <input type="radio" name="attr_tab" value="spells" class="tab-button spells-tab" />
    <div class="tab spells-tab"a>Spells</div>

    <input type="radio" name="attr_tab" value="traits" class="tab-button traits-tab" />
    <div class="tab traits-tab">Loadout</div>

    <input type="radio" name="attr_tab" value="combat" class="tab-button combat-tab" />
    <div class="tab combat-tab">Combat</div>

    <input type="radio" name="attr_tab" value="social" class="tab-button social-tab" />
    <div class="tab social-tab">Health</div>

    <input type="radio" name="attr_tab" value="inventory" class="tab-button inventory-tab" />
    <div class="tab inventory-tab">Inventory</div>

    <input type="radio" name="attr_tab" value="lifepath" class="tab-button lifepath-tab" />
    <div class="tab lifepath-tab">Lifepath</div>

    <div class="tabs-hr"></div>

    <div class="stats-section">
        <div class="agility-box stats-box">
            <!--<label class="stat-label">Strength</label>-->
            <button name="roll_agility" type="roll" value="&{template:default} {{name=Agility}} {{Result=[[d20+(@{Agility})]]}}">
                <span>Agility</span>
            </button>
            <input type="number" name="attr_Agility" class="stat-input" step="1" value="1"/>
        </div>
        <div class="concentration-box stats-box">
            <!--<label class="stat-label">Dexterity</label>-->
            <button name="roll_concentration" type="roll" value="&{template:default} {{name=Concentration}} {{Result=[[d20+(@{Concentration})]]}}">
                <span>Concentration</span>
            </button>
            <input type="number" name="attr_Concentration" class="stat-input" step="1" value="1"/>
        </div>
        <div class="endurance-box stats-box">
            <!--<label class="stat-label">Speed</label>-->
            <button name="roll_endurance" type="roll" value="&{template:default} {{name=Endurance}} {{Result=[[d20+(@{Endurance})]]}}">
                <span>Endurance</span>
            </button>
            <input type="number" name="attr_Endurance" class="stat-input" step="1" value="1" />
        </div>
        <div class="memory-box stats-box">
            <!--<label class="stat-label">Endurance</label>-->
            <button name="roll_memory" type="roll" value="&{template:default} {{name=Memory}} {{Result=[[d20+(@{Memory})]]}}">
                <span>Memory</span>
            </button>
            <input type="number" name="attr_Memory" class="stat-input" step="1" value="1" />
        </div>
        <div class="sensing-box stats-box">
            <!--<label class="stat-label">Intelligence</label>-->
            <button name="roll_sensing" type="roll" value="!SenseCheck @{selected|token_id}">
                <span>Sensing</span>
            </button>
            <input type="number" name="attr_Sensing" class="stat-input" step="1" value="1" />
        </div>
		<div class="spirit-bar">
		  <input name="attr_spirit_orb" class="rangespirit" type="range" min="0" max="100" value="100">
          <div class="spirit-label">Spirit</div>
		  <div class="spirit-numbers">
			  <input type="number" class="spirit-numbers-label" name="attr_spirit" value="100"/>
			  <span class="spirit-numbers-span">/</span>
			  <input type="number" class="spirit-numbers-label" name="attr_spirit_max" value="100"/>
		  </div>
          <input name="attr_spirit_orb" type="hidden" value="100">
        </div>


        <input type="hidden" name="attr_Binding" value="0">
        <input type="hidden" name="attr_Binding_max" value="@{spirit}">
        <input type="hidden" name="attr_body_parts" value="Torso|Head|Left Arm|Right Arm|Left Leg|Right Leg">
        <input type="hidden" name="attr_Bolster_Bonus" value="0">
        <input type="hidden" name="attr_Bolster_Bonus_max" value="4">
    </div>

    <div class="basics-section">
        <div class="name-line">
            <label class="basics-label">Name</label>
            <input type="text" name="attr_character_name" class="line-input name-input" />
        </div>
        <div class="people-line">
            <input class="arrow-toggle" type="checkbox" />
            <span class="arrow-label">&#9658;</span>
            <label class="basics-label people-label">People</label>
            <input type="text" name="attr_People" class="line-input people-input" />
            <div class="spell-notes">
                <textarea class="people-notes-input" name="attr_People_Notes" placeholder="Notes"></textarea>
            </div>
        </div>

        <hr class="basics-divider" />

        <div class="creed-line">
            <label class="basics-label">Creed</label>
            <input type="text" name="attr_Creed" class="line-input creed-input" />
        </div>
        <div class="idiosyncrasy-line">
            <label class="basics-label">Idiosyncrasy</label>
            <input type="text" name="attr_Idiosyncrasy" class="line-input idiosyncrasy-input" />
        </div>

        <hr class="basics-divider" />

        <div class="luck-box">
            <div class="current-luck-box stats-box">
                <label class="stat-label">Level</label>
                <input type="number" name="attr_Level" class="stat-input" step="1" value="5" />
            </div>

            <hr class="basics-divider" />

            <h3 class="traits-header">Ambitions</h3>
            <input type="text" class="ambition-input line-input" name="attr_Ambition1" placeholder="Long-Term Ambition" />
            <input type="text" class="ambition-input line-input" name="attr_Ambition2" placeholder="Short-Term Ambition" />
            <input type="text" class="ambition-input line-input" name="attr_Ambition3" placeholder="Short-Term Ambition" />
            <input type="text" class="ambition-input line-input" name="attr_Ambition4" placeholder="Party Ambition" />
        </div>
        <div class="experiences-box">
            <h3 class="traits-header">Experiences</h3>
            <fieldset class="repeating_experiences">
                <div class="experience-line">
                    <input type="text" class="line-input experience-input" name="attr_Experience" placeholder="Experience" />
                    <input type="checkbox" class="line-input influence-spent" name="attr_Exhausted" />
                </div>
            </fieldset>
        </div>

        <hr class="basics-divider" />

        <h3 class="traits-header">Notes</h3>
        <textarea class="traits-input" name="attr_Notes"></textarea>
    </div>

    <div class="spells-section">
        <div class="spell-hs-column">
            <h3 class="spell-header">Hand Seal Spells</h3>
            <input type="hidden" name="attr_newHS"/>
            <fieldset class="repeating_spellsHS">
                <input class="arrow-toggle" type="checkbox" />
                <span class="arrow-label">&#9658;</span>
                
                <input type="text" class="spell-magnitude" name="attr_Magnitude" value="0"/>
                    <!--<div class="spell-line">-->
                <span class="spell-top-row">   
                    <input type="text" class="spell-input line-input" name="attr_SpellName" value="Name"/>
                    <input type="hidden" name="attr_SpellID" value="Nothing here">
                    <button class="spell-roll" name="roll_Spell" type="roll" value="!HSInit;;@{SpellID}"/>
                <!--</div>-->
                </span>
                <div class="spell-bottom-row">
                    <input type="hidden" name="attr_RowID">
                    <input type="hidden" class="spell-type-display" name="attr_SpellType" value="Exorcism">
                    <img class="spell-type-image image-projectile" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/projectile.svg" title="Projectile">
                    <img class="spell-type-image image-area" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/area.svg" title="Area">
                    <img class="spell-type-image image-living" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/living.svg" title="Living">
                    <img class="spell-type-image image-bind" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/crossed-chains.svg" title="Binding">
                    <img class="spell-type-image image-recover" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/doubled.svg" title="Spirit Flow">
                    <img class="spell-type-image image-barrier" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/shield-reflect.svg" title="Barrier">
                    <img class="spell-type-image image-stealth" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/ninja-mask.svg" title="Stealth">
                    <img class="spell-type-image image-exorcism" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/pentagram-rose.svg" title="Exorcism">
                    <input type="hidden" class="spell-damage-type" name="attr_DamageType" value=""/>
                    <select class="spell-damage" name="attr_damage_type">
                        <option style="color:#D4111C" value="Fire">Fire</option>
                        <option style="color:#4999E8" value="Water" selected>Water</option>
                        <option style="color:#8D5929" value="Earth">Earth</option>
                        <option style="color:#AFAFAF" value="Metal">Metal</option>
                        <option style="color:#538F10" value="Wood">Wood</option>
                        <option style="color:#ffd966" value="Bind">Bind</option>
                        <option style="color:#43e5f7" value="Drain">Drain</option>
                        <option style="color:black" value="Impact">Impact</option>
                        <option style="color:black" value="-">-</option>
                    </select>
                    <input type="text" class="spell-damage-display line-noninput" name="attr_DamageType" value="Fire"/>
                    <input type="hidden" name="attr_Cost" value="0 Hand"/>
                    <input type="text" class="line-noninput spell-hs-cost" name="attr_cost_num" value="1" />
                    <input type="hidden" class="spell-cost-display" name="attr_cost_type" value="2Hand">
                    <img class="spell-hs-cost-image image-1hand" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/hand.svg" title="One-handed Seals">
                    <img class="spell-hs-cost-image image-2hand" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/gloves.svg" title="Two-handed Seals">
                    
                </div>
                
                <div class="spell-notes">
                    <textarea class="spell-hs-notes-input" name="attr_Info" placeholder="Notes"></textarea>
                </div>
            </fieldset>
        </div>

        <div class="spell-t-column">
            <h3 class="spell-header">Talisman Spells</h3>
            <fieldset class="repeating_spellsT">
                <input class="arrow-toggle" type="checkbox" />
                <span class="arrow-label">&#9658;</span>
                
                <input type="text" class="spell-magnitude" name="attr_Magnitude" value="0"/>
                    <!--<div class="spell-line">-->
                <span class="spell-top-row">   
                    <input type="text" class="spell-input line-input" name="attr_SpellName" value="Name"/>
                    <input type="hidden" name="attr_SpellID" value="Nothing here">
                    <button class="spell-roll t-button" name="roll_Spell" type="roll" value="!TalismanOptions;;@{SpellID}"/>
                <!--</div>-->
                </span>
                <div class="spell-bottom-row">
                    <input type="hidden" class="spell-type-display" name="attr_SpellType" value="Living">
                    <img class="spell-type-image image-projectile" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/projectile.svg" title="Projectile">
                    <img class="spell-type-image image-area" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/area.svg" title="Area">
                    <img class="spell-type-image image-living" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/living.svg" title="Living">
                    <img class="spell-type-image image-bind" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/crossed-chains.svg" title="Binding">
                    <input type="hidden" class="spell-damage-type" name="attr_DamageType" value=""/>
                    <select class="spell-damage" name="attr_damage_type">
                        <option style="color:#D4111C" value="Fire">Fire</option>
                        <option style="color:#4999E8" value="Water" selected>Water</option>
                        <option style="color:#8D5929" value="Earth">Earth</option>
                        <option style="color:#AFAFAF" value="Metal">Metal</option>
                        <option style="color:#538F10" value="Wood">Wood</option>
                        <option style="color:#ffd966" value="Bind">Bind</option>
                        <option style="color:#43e5f7" value="Drain">Drain</option>
                        <option style="color:black" value="Impact">Impact</option>
                    </select>
                    <input type="text" class="spell-damage-display line-noninput" name="attr_DamageType" value="Fire"/>
                </div>
                <div class="spell-cost-row">
                    <input type="hidden" name="attr_Cost" value="0 Metal"/>
                    <input type="hidden" class="spell-cost-display" name="attr_cost_Fire" value="">
                    <input type="hidden" class="spell-cost-display" name="attr_cost_Water" value="">
                    <input type="hidden" class="spell-cost-display" name="attr_cost_Earth" value="">
                    <input type="hidden" class="spell-cost-display" name="attr_cost_Metal" value="">
                    <input type="hidden" class="spell-cost-display" name="attr_cost_Wood" value="">
                    
                    <img class="spell-cost-image image-fire" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/candlebright.png" title="Fire Talismans">
                    <input type="text" class="line-noninput spell-cost cost-fire" name="attr_cost_num_Fire" value="" />
                    <img class="spell-cost-image image-water" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/water-drop.png" title="Water Talismans">
                    <input type="text" class="line-noninput spell-cost cost-water" name="attr_cost_num_Water" value="" />
                    <img class="spell-cost-image image-earth" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/peaks.png" title="Earth Talismans">
                    <input type="text" class="line-noninput spell-cost cost-earth" name="attr_cost_num_Earth" value="" />
                    <img class="spell-cost-image image-metal" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/anvil.png" title="Metal Talismans">
                    <input type="text" class="line-noninput spell-cost cost-metal" name="attr_cost_num_Metal" value="" />
                    <img class="spell-cost-image image-wood" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/beech.png" title="Wood Talismans">                    
                    <input type="text" class="line-noninput spell-cost cost-wood" name="attr_cost_num_Wood" value="" />
                </div>
                <div class="spell-notes">
                    <textarea class="spell-t-notes-input" name="attr_Info" placeholder="Notes"></textarea>
                    <span class="spell-scaling-label">Scaling</span>
                    <textarea class="spell-t-scaling-input" name="attr_Scaling" placeholder="Scaling"></textarea>
                </div>
            </fieldset>
        </div>

    </div>

    <div class="traits-section">
		<span class="current-talismans" >Current &nbsp;&nbsp;&nbsp;&nbsp; Max</span>
		<div class="fire-talismans">
			<img class="symbol-small" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/candlebright.png" >
			<input type="number" name="attr_fire_current" class="talisman-capacity" value="20" />
			<span>/</span>
			<input type="number" name="attr_fire_capacity" class="talisman-capacity" value="20" />
		</div>
		<div class="water-talismans">
			<img class="symbol-small" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/water-drop.png" >
			<input type="number" name="attr_water_current" class="talisman-capacity" value="20" />
			<span>/</span>
			<input type="number" name="attr_water_capacity" class="talisman-capacity" value="20" />
		</div>
		<div class="metal-talismans">
			<img class="symbol-small" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/anvil.png" >
			<input type="number" name="attr_metal_current" class="talisman-capacity" value="20" />
			<span>/</span>
			<input type="number" name="attr_metal_capacity" class="talisman-capacity" value="20" />
		</div>
		<div class="wood-talismans">
			<img class="symbol-small" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/beech.png" >
			<input type="number" name="attr_wood_current" class="talisman-capacity" value="20" />
			<span>/</span>
			<input type="number" name="attr_wood_capacity" class="talisman-capacity" value="20" />
		</div>
		<div class="earth-talismans">
			<img class="symbol-small" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/icons/peaks.png" >
			<input type="number" name="attr_earth_current" class="talisman-capacity" value="20" />
			<span>/</span>
			<input type="number" name="attr_earth_capacity" class="talisman-capacity" value="20" />
		</div>
		<div class="talisman-total">
			<input type="hidden" name="attr_talisman_total" value="100"/>
			<input type="hidden" name="attr_talisman_capacity" value="100"/>
			<span>Total: </span>
			<input type="number" name="attr_talisman_display_total" class="talisman-capacity total-capacity" value="@{talisman_total}" disabled="true" />
			<span>/</span>
			<input type="number" name="attr_talisman_display_capacity" class="talisman-capacity total-capacity" value="@{talisman_capacity}" disabled="true" />
		</div>
		<input type="hidden" name="attr_talisman_over" class="talisman-over" value="1" />
		<div class="talisman-over">
			<span>The total talisman carried exceeds the capacity!</span>
		</div>
    </div>

    <div class="combat-section">
        <h3 class="traits-header">Current Combat Scores</h3>
        <div class="combat-scores-box">
            <div class="pa-box stats-box">
                <label class="stat-label">Physical Armor</label>
                <input type="hidden" name="attr_PhysicalArmor" value="0" />
                <input type="number" name="attr_PhysicalArmor_label" class="stat-input" value="@{PhysicalArmor}" disabled />
            </div>
            <div class="sa-box stats-box">
                <label class="stat-label">Spirit Armor</label>
                <input type="hidden" name="attr_SpiritArmor" value="0" />
                <input type="number" name="attr_SpiritArmor_label" class="stat-input" value="@{SpiritArmor}" disabled />
            </div>
            <div class="dodges-box stats-box">
                <label class="stat-label">Dodges</label>
                <input type="hidden" name="attr_Dodges" class="stat-input" value="1" />
                <input type="hidden" name="attr_Dodges_max" class="stat-input" value="1"/>
                <input type="number" name="attr_Dodges_label" class="stat-input" value="@{Dodges}" disabled />
            </div>
            <div class="move-box stats-box">
                <label class="stat-label">Movement</label>
                <!-- <input type="hidden" name="attr_Move_reduce" class="stat-input" value="0" /> -->
                <input type="hidden" name="attr_Move" class="stat-input" value="20" />
                <input type="hidden" name="attr_Move_max" class="stat-input" value="20" />
                <input type="number" name="attr_Move_label" class="stat-input" step="1" value="@{Move_max}" disabled />
            </div>
            <!-- <div class="hsmod-box stats-box">
                <label class="stat-label">Hand Seal Mod</label>
                <input type="hidden" name="attr_HSMod" class="stat-input" value="0"/>
                <input type="number" name="attr_HSMod_label" class="stat-input" step="1" value="@{HSMod}" disabled />
            </div>
            <div class="tmod-box stats-box">    
                <label class="stat-label">Talisman Mod</label>
                <input type="hidden" name="attr_TMod" class="stat-input" value="0"/>
                <input type="number" name="attr_TMod_label" class="stat-input" step="1" value="@{TMod}" disabled />
            </div>
            <div class="weaponmod-box stats-box">
                <label class="stat-label">Weapon Mod</label>
                <input type="hidden" name="attr_WeaponMod" class="stat-input" value="0"/>
                <input type="number" name="attr_WeaponMod_label" class="stat-input" step="1" value="@{WeaponMod}" disabled />
            </div> -->
            <div class="hsperturn-box stats-box">
                <label class="stat-label">HS Per Turn</label>
                <input type="hidden" name="attr_hsPerTurn_max" class="stat-input" value="4"/>
                <input type="number" name="attr_hsPerTurn" class="stat-input" step="1" value="4" />
            </div>
        </div>

        <h3 class="traits-header">Weapons</h3>
        <fieldset class="repeating_attacks">
            <div class="weapon-line">
                <input type="hidden" class="weapon-magnitude" name="attr_WeaponMag" value="1"/>
                <input type="hidden" name="attr_WeaponID" value="1"/>
                <input type="text" class="weapon-input line-input" name="attr_WeaponName" value="Weapon" />
                <input type="hidden" class="weapon-equip-state" name="attr_WeaponEquip" value="Equip"/>
                <input type="hidden" name="attr_RowID" value=""/> <!--gets populated in API creation-->
                <div class="tooltip">
                    <input type="text" class="weapon-type-input line-input" name="attr_WeaponType" value="Type" />
                    <textarea class="tooltiptext" name="attr_WeaponTypeTip" placeholder="This is the property associated with the weapon type." >
                    </textarea>
                </div>
                <button name="roll_equip_weapon" class="equip-button" type="roll" value="!EquipWeapon;;@{WeaponID};;@{RowID}">
                    <span name="attr_WeaponEquip"></span>
                </button>

                <div>
                    <input type="text" class="attack-properties line-input" name="attr_WeaponStats" placeholder="Bonus Stats"/>
                </div>

                <!-- Basic Attack -->
                <div class="attack-line">
                    <div>
                        <input type="text" class="attack-input line-input" name="attr_BasicAttackName" value="Attack" />
                        <input type="text" class="attack-damage line-input" name="attr_BasicAttackDamage" placeholder="1d6" />
                        <input type="text" class="attack-cost line-input" name="attr_BasicAttackCost" placeholder="" />
                        <button name="roll_attack" class="attack-button" type="roll" value="!WeaponAttack;;;;@{WeaponID}"></button>
                    </div>
                    <input class="arrow-toggle" type="checkbox" />
                    <span class="arrow-label">&#9658;</span>
                    <div>
                        <input type="text" class="attack-properties line-input" name="attr_BasicAttackProperties" placeholder="Properties" />
                    </div>
                    <div class="weapon-notes">
                        <textarea class="attack-notes-input" name="attr_BasicNotes" placeholder="Notes"></textarea>
                    </div>
                </div>

                <!-- Toggle Ability -->
                <div class="attack-line">
                    <div>
                        <input type="hidden" class="weapon-equip-state" name="attr_ToggleState" value="Toggle On"/>
                        <input type="text" class="attack-input line-input" name="attr_ToggleAttackName" value="Toggle" />
                        <!-- <input type="text" class="attack-damage line-input" name="attr_AttackDamage" placeholder="1d6" /> -->
                        <input type="text" class="attack-cost line-input" name="attr_ToggleAttackCost" placeholder="" />
                        <button name="roll_attack" class="equip-button" type="roll" value="!ToggleAbility;;@{ToggleAttackName};;@{RowID}">
                            <span name="attr_ToggleState"></span>
                        </button>
                    </div>
                    <input class="arrow-toggle" type="checkbox" />
                    <span class="arrow-label">&#9658;</span>
                    <div>
                        <input type="text" class="attack-properties line-input" name="attr_ToggleAttackProperties" placeholder="Properties" />
                    </div>
                    <div class="weapon-notes">
                        <textarea class="attack-notes-input" name="attr_ToggleNotes" placeholder="Notes"></textarea>
                    </div>
                </div>

                <!-- Burst Attack -->
                <div class="attack-line">
                    <div>
                        <input type="text" class="attack-input line-input" name="attr_BurstAttackName" value="Attack" />
                        <input type="text" class="attack-damage line-input" name="attr_BurstAttackDamage" placeholder="1d6" />
                        <input type="text" class="attack-cost line-input" name="attr_BurstAttackCost" placeholder="" />
                        <button name="roll_attack" class="attack-button" type="roll" value="!WeaponAttack;;burst;;@{WeaponID}"></button>
                    </div>
                    <input class="arrow-toggle" type="checkbox" />
                    <span class="arrow-label">&#9658;</span>
                    <div>
                        <input type="text" class="attack-properties line-input" name="attr_BurstAttackProperties" placeholder="Properties" />
                    </div>
                    <div class="weapon-notes">
                        <textarea class="attack-notes-input" name="attr_BurstNotes" placeholder="Notes"></textarea>
                    </div>
                </div>
            </div>
        </fieldset>

        <h3 class="traits-header">Consequences and Notes</h3>
        <textarea class="traits-input" name="attr_Consequences"></textarea>
    </div>

    <div class="social-section">
        <div class="social-box">
            <h3 class="traits-header">Health</h3>
            <div class="health-torso">
                <div class="health-label">Torso</div>
              <input name="attr_health_torso_percent" class="rangehealth" type="range" min="0" max="100" value="100">
              <div class="health-numbers">
                  <input type="number" class="health-numbers-label" name="attr_health_torso" value="25"/>
                  <span class="health-numbers-span">/</span>
                  <input type="number" class="health-numbers-label" name="attr_health_torso_max" value="25"/>
              </div>
              <input name="attr_health_torso_percent" type="hidden" value="100">
            </div>
            <div class="health-left-arm">
                <div class="health-label">Left Arm</div>
              <input name="attr_health_left_arm_percent" class="rangehealth" type="range" min="0" max="100" value="100">
              <div class="health-numbers">
                <input type="number" class="health-numbers-label" name="attr_health_left_arm" value="10"/>
                  <!-- <input type="number" class="health-numbers-label" name="attr_health_left_arm_label" value="@{health_left_arm}" disabled="true" /> -->
                  <span class="health-numbers-span">/</span>
                  <input type="number" class="health-numbers-label" name="attr_health_left_arm_max" value="10"/>
                  <!-- <input type="number" class="health-numbers-label" name="attr_health_left_arm_max_label" value="@{health_left_arm_max}" disabled="true"/> -->
              </div>
              <input name="attr_health_left_arm_percent" type="hidden" value="100">
            </div>
            <div class="health-right-arm">
                <div class="health-label">Right Arm</div>
              <input name="attr_health_right_arm_percent" class="rangehealth" type="range" min="0" max="100" value="100">
              <div class="health-numbers">
                  <input type="number" class="health-numbers-label" name="attr_health_right_arm" value="10"/>
                  <span class="health-numbers-span">/</span>
                  <input type="number" class="health-numbers-label" name="attr_health_right_arm_max" value="10"/>
              </div>
              <input name="attr_health_right_arm_percent" type="hidden" value="100">
            </div>
            <div class="health-left-leg">
                <div class="health-label">Left Leg</div>
              <input name="attr_health_left_leg_percent" class="rangehealth" type="range" min="0" max="100" value="100">
              <div class="health-numbers">
                  <input type="number" class="health-numbers-label" name="attr_health_left_leg" value="15"/>
                  <span class="health-numbers-span">/</span>
                  <input type="number" class="health-numbers-label" name="attr_health_left_leg_max" value="15"/>
              </div>
              <input name="attr_health_left_leg_percent" type="hidden" value="100">
            </div>
            <div class="health-right-leg">
                <div class="health-label">Right Leg</div>
              <input name="attr_health_right_leg_percent" class="rangehealth" type="range" min="0" max="100" value="100">
              <div class="health-numbers">
                  <input type="number" class="health-numbers-label" name="attr_health_right_leg" value="15"/>
                  <span class="health-numbers-span">/</span>
                  <input type="number" class="health-numbers-label" name="attr_health_right_leg_max" value="15"/>
              </div>
              <input name="attr_health_right_leg_percent" type="hidden" value="100">
            </div>
            <div class="health-head">
                <div class="health-label">Head</div>
              <input name="attr_health_head_percent" class="rangehealth" type="range" min="0" max="100" value="100">
              <div class="health-numbers">
                  <input type="number" class="health-numbers-label" name="attr_health_head" value="5"/>
                  <span class="health-numbers-span">/</span>
                  <input type="number" class="health-numbers-label" name="attr_health_head_max" value="5"/>
              </div>
              <input name="attr_health_head_percent" type="hidden" value="100">
            </div>
            <img class="health-body" src="https://raw.githubusercontent.com/TheScottishninja/Onmyoji/main/body_solid.png">
        </div>
        <div class="social-box">
            <h3 class="traits-header">Injuries</h3>

        </div>
    </div>

    <div class="inventory-section">
        <h3 class="traits-header">Quick Inventory</h3>
        <textarea class="inventory-quick" name="attr_Inventory"></textarea>
        <h3 class="traits-header">Equipment</h3>
        <fieldset class="repeating_items">
            <input class="arrow-toggle" type="checkbox" />
            <span class="arrow-label">&#9658;</span>
            <div class="item-line">
                <input type="text" class="item-name line-input" name="attr_Item" placeholder="Item" />
                <input type="text" class="item-properties line-input" name="attr_Properties" placeholder="Properties" />
                <input type="text" class="item-number line-input" name="attr_Numbers" placeholder="#" />
                <input type="text" class="item-page line-input" name="attr_Reference" placeholder="Page" />
            </div>
            <div class="item-notes">
                <textarea class="item-notes-input" name="attr_Notes" placeholder="Notes"></textarea>
            </div>
        </fieldset>

        <div class="social-box">
            <h3 class="traits-header">Wealth</h3>
            <div class="inventory-wealth-box">
                <div class="gp-box wealth-box">
                    <label class="wealth-label">Gold</label>
                    <input type="number" name="attr_GP" class="wealth-input" step="1" value="0" />
                </div>
                <div class="sp-box wealth-box">
                    <label class="wealth-label">Silver</label>
                    <input type="number" name="attr_SP" class="wealth-input" step="1" value="0" />
                </div>
                <div class="bp-box wealth-box">
                    <label class="wealth-label">Bronze</label>
                    <input type="number" name="attr_BP" class="wealth-input" step="1" value="0" />
                </div>
                 <div class="bits-box wealth-box">
                    <label class="wealth-label">Bits</label>
                    <input type="number" name="attr_Bits" class="wealth-input" step="1" value="0" />
                </div>
            </div>
        </div>

        <div class="social-box">
            <h3 class="traits-header">Encumbrance</h3>
            <div class="inventory-wealth-box">
                <div class="wealth-box">
                    <label class="wealth-label">Current</label>
                    <input type="number" name="attr_Encumbrance" class="wealth-input" step="1" value="0" />
                </div>
                <div class="wealth-box">
                    <label class="wealth-label">Max</label>
                    <input type="number" name="attr_Encumbrance|max" class="wealth-input" value="floor((@{Strength}+@{Dexterity})/2)+@{Encumbrance_Mod}" disabled />
                </div>
                <div class="wealth-box">
                    <label class="wealth-label">Mod</label>
                    <input type="number" name="attr_Encumbrance_Mod" class="wealth-input" step="1" value="0" />
                </div>
            </div>
        </div>
    </div>

    <div class="lifepath-section">
        <div class="social-box">
            <h3 class="traits-header">Training Boxes</h3>
            <div class="training-boxes">
                <input type="checkbox" name="attr_Training_Box1" />
                <input type="checkbox" name="attr_Training_Box2" />
                <input type="checkbox" name="attr_Training_Box3" />
                <input type="checkbox" name="attr_Training_Box4" />
                <input type="checkbox" name="attr_Training_Box5" />
                &nbsp;
                <input type="checkbox" name="attr_Training_Box6" />
                <input type="checkbox" name="attr_Training_Box7" />
                <input type="checkbox" name="attr_Training_Box8" />
                <input type="checkbox" name="attr_Training_Box9" />
                <input type="checkbox" name="attr_Training_Box10" />
            </div>
            <h3 class="traits-header">Birth Fortune</h3>
            <textarea class="lifepath-textarea" name="attr_Birth_Fortune" placeholder="Birth Fortune"></textarea>
            <h3 class="traits-header">Origin</h3>
            <input type="text" name="attr_Origin" class="line-input lifepath-input" placeholder="Origin" />
            <input type="text" name="attr_People" class="line-input lifepath-input" placeholder="People" />
            <input type="text" name="attr_Religion" class="line-input lifepath-input" placeholder="Family Religion" />
            <textarea class="lifepath-textarea" name="attr_Foundational_Event"placeholder="Foundational Event"></textarea>
            <h3 class="traits-header">Coming of Age</h3>
            <input type="text" name="attr_character_name" class="line-input lifepath-input" placeholder="Name" />
            <h4 class="traits-header">Assign Stats: [ 7, 6, 6, 5, 5, 4, 4, 3 ]</h4>
            <input type="text" name="attr_Ambition1" class="line-input lifepath-input" placeholder="Adolescent Ambition" />

            <h3 class="traits-header">Finishing Touches</h3>
            <textarea class="lifepath-textarea" name="attr_Gather_Party" placeholder="Gathering the Party"></textarea>
            <h4 class="traits-header">Hearth & Coin</h4>
            <input type="number" name="attr_Age" class="line-input lifepath-age" step="1" placeholder="Age" />
            <select name="attr_Strata" class="strata-input">
                <option value="common">Common</option>
                <option value="gentle">Gentle</option>
                <option value="noble">Noble</option>
            </select>
            <input type="number" class="standing-input line-input" name="attr_Standing" placeholder="Standing" />
            <div class="lifepath-wealth-box">
                <div class="gp-box wealth-box">
                    <label class="wealth-label">Gold</label>
                    <input type="number" name="attr_GP" class="wealth-input" step="1" value="0" />
                </div>
                <div class="sp-box wealth-box">
                    <label class="wealth-label">Silver</label>
                    <input type="number" name="attr_SP" class="wealth-input" step="1" value="0" />
                </div>
                <div class="bp-box wealth-box">
                    <label class="wealth-label">Bronze</label>
                    <input type="number" name="attr_BP" class="wealth-input" step="1" value="0" />
                </div>
                 <div class="bits-box wealth-box">
                    <label class="wealth-label">Bits</label>
                    <input type="number" name="attr_Bits" class="wealth-input" step="1" value="0" />
                </div>
            </div>
            <h4 class="traits-header">Personal Traits</h4>
            <input type="text" name="attr_Creed" class="line-input lifepath-input" placeholder="Creed" />
            <input type="text" name="attr_Idiosyncrasy" class="line-input lifepath-input" placeholder="Idiosyncrasy" />
            <textarea class="lifepath-textarea" name="attr_Weaknesses" placeholder="Weaknesses"></textarea>
            <h4 class="traits-header">Ambitions</h4>
            <input type="text" name="attr_Ambition1" class="line-input lifepath-input" placeholder="Long-Term Ambition" />
            <input type="text" name="attr_Ambition2" class="line-input lifepath-input" placeholder="Short-Term Ambition" />
            <input type="text" name="attr_Ambition3" class="line-input lifepath-input" placeholder="Short-Term Ambition" />
            <input type="text" name="attr_Ambition4" class="line-input lifepath-input" placeholder="Party Ambition" />
        </div>
        <div class="social-box">
            <h3 class="traits-header">Careers</h3>
            <fieldset class="repeating_careers">
                <div class="attempt">
                    <input type="number" name="attr_Age" class="line-input career-age" step="1" placeholder="Age" />
                    <input type="text" name="attr_Career" class="line-input lifepath-career" placeholder="Career" />
                    <input type="text" name="attr_Training" class="line-input lifepath-input" placeholder="Training" />
                    <textarea class="lifepath-textarea" name="attr_Event" placeholder="Event"></textarea>
                    <input type="text" name="attr_Advancement" class="line-input lifepath-input" placeholder="Advancement" />
                    <input type="text" name="attr_Title" class="line-input lifepath-title" placeholder="Title" />
                    <select name="attr_Strata" class="strata-input career-strata">
                        <option value="common">Common</option>
                        <option value="gentle">Gentle</option>
                        <option value="noble">Noble</option>
                    </select>
                    <input type="number" class="standing-input line-input" name="attr_Standing" placeholder="Standing" />
                </div>
            </fieldset>
        </div>
    </div>
</div>

<script type="text/worker">

    on("sheet:opened change:fire_capacity change:water_capacity change:earth_capacity change:metal_capacity change:wood_capacity", function() {
    	getAttrs(["fire_capacity", "water_capacity", "earth_capacity", "metal_capacity", "wood_capacity", "talisman_capacity"], function(values) {
    		var total = parseInt(values.fire_capacity) + parseInt(values.water_capacity) + parseInt(values.earth_capacity) + parseInt(values.metal_capacity) + parseInt(values.wood_capacity);
    		setAttrs({"talisman_total": total});
    		
    		var capacity = parseInt(values.talisman_capacity);
    		if (total > capacity) {
    			setAttrs({talisman_over: "1"});
    		}
    		else {
    			setAttrs({talisman_over: "0"});
    		}
    	});
    });

    on("sheet:opened change:spirit change:spirit_max", function(){
    	getAttrs(["spirit", "spirit_max"], function(values){
    		var percent = (parseFloat(values.spirit) / parseFloat(values.spirit_max)) * 100;
    		setAttrs({"spirit_orb": percent});
    	});
    });

    const health = ['torso', 'left_arm', 'right_arm', 'left_leg', 'right_leg', 'head']
    health.forEach(function(part){
       on("sheet:opened change:health_" + part + " change:health_" + part + "_max", function(){
            getAttrs(["health_" + part, "health_" + part + "_max"], function(values){
                var percent = (parseFloat(values["health_" + part]) / parseFloat(values["health_" + part + "_max"])) * 100;
                setAttrs({["health_" + part + "_percent"]: percent});
            });
        }); 
    });

    on("change:repeating_spellsHS:damage_type", function(eventinfo){
        getAttrs(["repeating_spellsHS_damage_type"], function(values){
            setAttrs({
                repeating_spellsHS_DamageType: values.repeating_spellsHS_damage_type
            });
        });
    });

    on("change:repeating_spellsHS:Cost", function(){
        getAttrs(["repeating_spellsHS_Cost"], function(values){
            var cost = values.repeating_spellsHS_Cost.split(" ")
            setAttrs({
                repeating_spellsHS_cost_num: cost[0],
                repeating_spellsHS_cost_type: cost[1]
            });
        });
    });

    on("change:repeating_spellsT:damage_type", function(eventinfo){
        getAttrs(["repeating_spellsT_damage_type"], function(values){
            setAttrs({
                repeating_spellsT_DamageType: values.repeating_spellsT_damage_type
            });
        });
    });

    on("change:repeating_spellsT:Cost", function(){
        getAttrs(["repeating_spellsT_Cost"], function(values){
            var cost = values.repeating_spellsT_Cost.split(" ")
            setAttrs({
                repeating_spellsT_cost_num: cost[0],
                repeating_spellsT_cost_type: cost[1]
            });
        });
    });

    on("change:newHS", function(){
        console.log("trigger")
        setAttrs({
            newHS: "0"
        });
    });


</script>